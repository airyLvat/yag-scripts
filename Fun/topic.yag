{{$name := "ConversationTopic"}}
{{$lengthSec := 60}}
{{$id := 0}}
{{$key := print "cooldown_" $name}}

{{if dbGet (toInt64 $id) $key}}
    {{deleteTrigger 5}}
	{{$x := sendMessageRetID nil "`^topic` is on cooldown for 60 seconds"}}
    {{deleteMessage nil $x 5}}
{{else}}
    {{dbSetExpire (toInt64 $id) $key "cooldown" $lengthSec}}
	{{$topicRepo := 1121888104186396714}}
    {{$messageList := cslice
    1121889060215074947
    1121889078862958683
    1121889097586315445
    1121889116460683274
    1121889131786674276
    1121889147729227817
    1121889170307158127
    1121889189693239297
    1121889212900327464
    1121889248283467807
    1121889233087496192
    1121889270924329001
    1121889288095793283
    1121889301978947695
    1121889319720861827
    1121889335973789888
    1121889351794696262
    1121889367967932437
    1121889384631902349
    1121889402189262978
    1121889418727407737
    1121889433411670216
    1121889451912740955
    1121889468480233584
    1121889489023938681
    1121889506203816036
    1121889569613295627
    1121889591083925504
    1121889610977509386
    1121889633261867087
    1121889648571064462
    1121889664157102121
    1121889678338035723
    1121889695291416646
    1121889712685191208
    1121889727361061034
    1121889742456361050
    1121889758138880083
    1121889776803528784
    1121889799746359437
    1121889817400193109
    1121889842003984456
    1121889858508558366
    1121889873918443551
    1121889887898050732
    1121889901072359564
    1121889916247351337
    1121889937420202106
    1121889951739547698
    1121889967749214319
    1121889981259059202
    1121889997637816440
    1121890013966258246
    1121890031368425674
    1121890048384704612
    1121890065178697828
    1121890081934954676
    1121890097151881346
    1121890116382769213
    1121890133671690290
    1121890150377594984
    1121890166404022373
    1121890185152569354
    1121890256032116866
    1121890271488118804
    1121890286042362018
    1121890301104095242
    1121890317524807871
    1121890330887856198
    1121890346159308901
    1121890361732759682
    1121890376748384318
    1121890390581186763
    1121890403881320478
    1121890417764487199
    1121890486207135795
    1121890499905720490
    1121890513121968179
    1121890533216882829
    1121890544151429191
    1121890564313469080
    1121890581002600489
    1121890608622088192
    1121890623239241780
    1121890641257963520
    1121890655510212688
    1121890670077018224
    1121890686296395846
    1121890702394134569
    1121890717325865011
    1121890731758452866
    1121890746581139648
    1121890761273790544
    1121890775903522846
    1121890790143184987
    1121890805683060826
    1121890821839519755
    1121890843494719588
    1121890856954232873
    1121890871235846155
    1121890883491598486
    1121890897274081400
    1121890909601136751
    1121890922859352074
    1121890936885104742
    1121890951988793434
    1121890968342368368
    1121890982674301029
    1121890995609550948
    1121891009341694073
    1121891022012682320
    1121891036734697642
    1121891050341027960
    1121891063813111979
    1121891077268443186
    1121891090333708298
    1121891105760358480
    1121891119228264510
    1121891132209647688
    1121891145874677791
    1121891158805721108
    1121891171313127544
    1121891184361615380
    1121891198227980368
    1121891214594158653
    1121891229387477022
    1121891245774610453
    1121891257799688262
    1121891271380844595
    1121891288304861315
    1121891301852446860
    1121891314942881832
    1121891330403086346
    1121891345120890922
    1121891360195223602
    1121891372065116211
    1121891385595940995
    1121891399030276218
    1121891412003262504
    1121891425211133952
    1121891438989414490
    1121891452058873916
    1121891468437622835
    1121891482383683666
    1121891501320962108
    1121891516835696744
    1121891529179537438
    1121891544283238571
    1121891561354039331
    1121891577380470866
    1121891598008078396
    }}

    {{$topicIndex := toInt (dbGet .BotUser.ID $name).Value}}
    {{if gt $topicIndex (sub (len $messageList) 1)}}{{$topicIndex = 0}}{{end}}
    {{$topicID:= index $messageList $topicIndex}}
    {{dbSet .BotUser.ID $name (add $topicIndex 1)}}

    {{$topic := (getMessage $topicRepo $topicID).Content}}
    
    {{$message := cembed "description" (joinStr "" "### " $topic) "color" 0x11FF99 "author" (sdict "name" (joinStr "" .Guild.Name " conversation topic") "icon_url" (joinStr "" "https://cdn.discordapp.com/icons/" .Guild.ID "/" .Guild.Icon ".png")) "footer" (sdict "text" (joinStr "" "Conversation topic (" (add $topicIndex 1) " of " (len $messageList) ") requested by: " (or ((getMember .User.ID).Nick) .User.Globalname .User.Username)))}}
	{{sendMessage nil $message}}
	{{addReactions "âœ…"}}
{{end}}
